<div {{ attributes }}>
    <form
            data-action="live#action:prevent"
            data-live-action-param="saveEvent"
    >
        <div class="row align-items-center">
            <div class="col-3">
                <label for="event-name">Event name:</label>
            </div>
            <div class="col-6">
                <input
                        type="text"
                        data-model="name"
                        class="form-control {{ _errors.has('name') ? 'is-invalid' }}"
                        id="event-name"
                >
                {% if _errors.has('name') %}
                    <div class="invalid-feedback">
                        {{ _errors.get('name') }}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="row align-items-center mt-3">
            <div class="col-3">
                <label for="event-description">Description:</label>
            </div>
            <div class="col-6">
                <textarea
                        data-model="description"
                        class="form-control {{ _errors.has('description') ? 'is-invalid' }}"
                        id="event-description"
                ></textarea>
                {% if _errors.has('description') %}
                    <div class="invalid-feedback">
                        {{ _errors.get('description') }}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="row align-items-center mt-3">
            <div class="col-3">
                <label for="event-isAccessible" class="form-check-label">Accessible:</label>
            </div>
            <div class="col-6">
                <input
                        type="checkbox"
                        data-model="isAccessible"
                        class="form-check-input {{ _errors.has('isAccessible') ? 'is-invalid' }}"
                        id="event-isAccessible"
                >
                {% if _errors.has('isAccessible') %}
                    <div class="invalid-feedback">
                        {{ _errors.get('isAccessible') }}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="row align-items-center mt-3">
            <div class="col-3">
                <label for="event-startAt">Start date:</label>
            </div>
            <div class="col-6">
                <input
                        type="date"
                        data-model="startAt"
                        class="form-control {{ _errors.has('startAt') ? 'is-invalid' }}"
                        id="event-startAt"
                >
                {% if _errors.has('startAt') %}
                    <div class="invalid-feedback">
                        {{ _errors.get('startAt') }}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="row align-items-center mt-3">
            <div class="col-3">
                <label for="event-endAt">End date:</label>
            </div>
            <div class="col-6">
                <input
                        type="date"
                        data-model="endAt"
                        class="form-control {{ _errors.has('endAt') ? 'is-invalid' }}"
                        id="event-endAt"
                >
                {% if _errors.has('endAt') %}
                    <div class="invalid-feedback">
                        {{ _errors.get('endAt') }}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="row align-items-center mt-3">
            <div class="col-3">
                <label for="event-prerequisites">Prerequisites:</label>
            </div>
            <div class="col-6">
                <textarea
                        data-model="prerequisites"
                        class="form-control {{ _errors.has('prerequisites') ? 'is-invalid' }}"
                        id="event-prerequisites"
                ></textarea>
                {% if _errors.has('prerequisites') %}
                    <div class="invalid-feedback">
                        {{ _errors.get('prerequisites') }}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="row align-items-center mt-3">
            <div class="col-3">
                <label for="event-organizations">Organizations:</label>
            </div>
            <div class="col-6">
                <select
                        data-model="organizations"
                        id="event-organizations"
                        class="form-control {{ _errors.has('organizations') ? 'is-invalid' }}"
                        data-skip-morph
                        multiple
                        {{ stimulus_controller('symfony/ux-autocomplete/autocomplete', {
                            url: path('ux_entity_autocomplete', { alias: 'organization' }),
                        }) }}
                >
                    <option value="">Choose an organization</option>
                    {% for org_option in allOrgs %}
                        <option value="{{ org_option.id }}" {{ this.isOrgSelected(org_option) ? 'selected' }}>{{ org_option.name }}</option>
                    {% endfor %}
                </select>
                {% if _errors.has('organizations') %}
                    <div class="invalid-feedback">
                        {{ _errors.get('organizations') }}
                    </div>
                {% endif %}
            </div>
            <div class="col-auto">
                <div class="form-text">
                    <a
                            type="button"
                            data-bs-toggle="modal"
                            data-bs-target="#new-org-modal"
                    >+ Add Organization
                    </a>
                </div>
            </div>
        </div>

        <div class="row align-items-center mt-3">
            <div class="col-3">
                <label for="event-project">Project:</label>
            </div>
            <div class="col-6">
                <select
                        data-model="project"
                        id="event-project"
                        class="form-control {{ _errors.has('project') ? 'is-invalid' }}"
                        data-skip-morph
                        {{ stimulus_controller('symfony/ux-autocomplete/autocomplete', {
                            url: path('ux_entity_autocomplete', { alias: 'project' }),
                        }) }}
                >
                    <option value="">Choose a Project</option>
                    {% for project_option in projects %}
                        <option value="{{ project_option.id }}" {{ this.isProjectSelected(project_option) ? 'selected' }}>{{ project_option.name }}</option>
                    {% endfor %}
                </select>
                {% if _errors.has('project') %}
                    <div class="invalid-feedback">
                        {{ _errors.get('project') }}
                    </div>
                {% endif %}
            </div>
            <div class="col-auto">
                <div class="form-text">
                    <a
                            type="button"
                            data-bs-toggle="modal"
                            data-bs-target="#new-project-modal"
                    >+ Add Project
                    </a>
                </div>
            </div>
        </div>

        <div class="row align-items-center mt-3">
            <div class="col-3">
                <label for="event-tags">Tags:</label>
            </div>
            <div class="col-6">
                <select
                        data-model="tags"
                        id="event-tags"
                        class="form-control {{ _errors.has('tags') ? 'is-invalid' }}"
                        data-skip-morph
                        multiple
                        {{ stimulus_controller('symfony/ux-autocomplete/autocomplete', {
                            url: path('ux_entity_autocomplete', { alias: 'tag' }),
                        }) }}
                >
                    <option value="">Choose tags</option>
                    {% for tag_option in allTags %}
                        <option value="{{ tag_option.id }}" {{ this.isTagSelected(tag_option) ? 'selected' }}>{{ tag_option.name }}</option>
                    {% endfor %}
                </select>
                {% if _errors.has('tags') %}
                    <div class="invalid-feedback">
                        {{ _errors.get('tags') }}
                    </div>
                {% endif %}
            </div>
            <div class="col-auto">
                <div class="form-text">
                    <a
                            type="button"
                            data-bs-toggle="modal"
                            data-bs-target="#new-tag-modal"
                    >+ Add Tag
                    </a>
                </div>
            </div>
        </div>

        <div class="mt-3">
            <button type="submit" class="btn btn-primary">Save Event</button>
        </div>
    </form>

    {% component BootstrapModal with {id: 'new-tag-modal'} %}
        {% block modal_header %}
            <h5>Add a Tag</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        {% endblock %}
        {% block modal_body %}
            <twig:NewTagForm />
        {% endblock %}
    {% endcomponent %}
    {% component BootstrapModal with {id: 'new-project-modal'} %}
        {% block modal_header %}
            <h5>Add a Project</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        {% endblock %}
        {% block modal_body %}
            <twig:NewProjectForm />
        {% endblock %}
    {% endcomponent %}
    {% component BootstrapModal with {id: 'new-org-modal'} %}
        {% block modal_header %}
            <h5>Add an Organization</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        {% endblock %}
        {% block modal_body %}
            <twig:NewOrganizationForm />
        {% endblock %}
    {% endcomponent %}
</div>
